{% extends 'base.html' %}

{% block title %}뇌사XMatch알리미 - 근무자 관리{% endblock %}

{% block content %}
    <h1>근무자 관리</h1>

    <h2>새 근무자 추가</h2>
    <form action="{{ url_for('workers') }}" method="POST">
        <input type="text" name="name" placeholder="근무자 이름" required>
        <button type="submit">추가</button>
    </form>

    <h2>현재 근무자 목록 (드래그 앤 드롭으로 순서 변경 가능)</h2>
    {% if workers %}
        <ul id="worker-list">
            {% for worker in workers %}
                <li data-id="{{ worker.id }}" class="worker-item {% if worker.is_off %}off-duty{% endif %}">
                    {{ worker.name }}
                    {% if worker.is_off %} (OFF) {% endif %}
                    <span>
                        <button class="toggle-off-btn" data-id="{{ worker.id }}" data-is-off="{{ worker.is_off | tojson }}">
                            {% if worker.is_off %} OFF 해제 {% else %} OFF 설정 {% endif %}
                        </button>
                        <a href="{{ url_for('delete_worker', id=worker.id) }}"
                           onclick="return confirm('{{ worker.name }} 님을 삭제하시겠습니까?');">
                            [삭제]
                        </a>
                    </span>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>등록된 근무자가 없습니다.</p>
    {% endif %}

    <p><a href="{{ url_for('index') }}">메인 페이지로 돌아가기</a></p>

    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.14.0/Sortable.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
{% endblock %}